import sys
import numpy as np
from hmmlearn.hmm import MultinomialHMM
import matplotlib.pyplot as plt
from hmmviz import TransGraph
import pandas as pd
import seaborn as sns
import pickle
import os
import json
import pprint


class HMM_model(object):
    def __init__(self, IDString, transmat, startprob, emissionprob, BIC, logLikelihood):
        self.IDString = IDString
        self.transmat = transmat
        self.startprob = startprob
        self.emissionprob = emissionprob
        self.BIC = BIC
        self.logLikelihood = logLikelihood


def calculateBIC(k, X, logLikelihood):
    """
           k - int. Number of parameters in the model. The parameter that we are trying to optimize.
                    For HMM it is number of states.
                    For GMM the number of components.
           X - array. Data that been fitted upon.
    """
    bic = np.log(len(X))*k - 2*logLikelihood
    return bic


# Re-categorized expert and intermediates grouping
Expert1StartEnd = [[0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 2, 1, 0, 2, 6, 6, 1, 2, 0, 0, 0, 3, 4, 3, 4, 3, 4, 1, 0, 0, 0, 0, 2, 1, 2, 1, 0, 0, 2, 1, 0, 2, 6, 1, 0, 0, 0, 0, 0, 0, 1, 2, 0, 2, 1, 0, 0, 2, 1, 2, 1, 2, 6, 6, 0, 0, 3, 4, 6, 1, 0, 0, 2, 0, 0, 6, 3, 0, 4, 1, 2, 1, 0, 0, 0, 2, 3, 4, 1, 2, 1, 0, 2, 1, 2, 1, 2, 6, 3, 4, 3, 4, 3, 4, 3, 4, 1, 2, 3, 4, 1, 2, 6, 0, 0, 0, 1, 0, 0, 0, 0, 0, 2, 1, 0, 2, 1, 2, 1, 0, 0, 0, 2, 1, 2, 6, 6, 3, 4, 0, 3, 4, 3, 4, 1, 0, 2, 0, 0], [0, 0, 0, 0, 0, 0, 1, 2, 0, 3, 0, 4, 3, 4, 0, 3, 0, 4, 3, 4, 1, 2, 0, 0, 1, 2, 1, 2, 0, 3, 4, 1, 2, 1, 2, 1, 2, 1, 2, 0, 1, 0, 2, 0, 3, 4, 1, 2, 0, 1, 2, 1, 2, 1, 2, 6, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 1, 2, 0, 3, 4, 3, 4, 1, 0, 2, 1, 2, 0, 0, 0, 0, 1, 2, 1, 2, 0, 1, 2, 3, 4, 0, 1, 2, 1, 2, 1, 2, 1, 2, 0, 6, 1, 2, 0, 3, 4, 1, 2, 1, 2, 0, 0, 3, 4, 3, 4, 5, 3, 4, 3, 4, 0, 1, 2, 1, 2, 0, 3, 4, 1, 2, 0, 0, 3, 4, 0, 0, 0, 0, 1, 1, 2, 2, 0, 3, 4, 0, 0, 0, 0, 0, 0, 1, 2, 0, 3, 4, 1, 2, 3, 4, 0, 3, 4, 0, 3, 4, 1, 2, 0, 1, 2, 1, 2, 0, 1, 2, 1, 2, 1, 2, 0, 0, 0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 0, 0, 0, 0, 0, 1, 2, 0, 1, 2, 3, 4, 3, 4, 6, 6, 3, 4, 3, 4, 3, 4, 0, 1, 1, 2, 0, 2, 0, 1, 2, 0, 3, 4, 1, 2, 1, 2, 0, 3, 4, 3, 4, 1, 2, 5, 0, 0], [0, 1, 2, 0, 3, 4, 1, 2, 0, 3, 4, 1, 2, 1, 2, 0, 3, 4, 0, 1, 2, 1, 0, 2, 1, 2, 0, 0, 5, 1, 2, 0, 5, 3, 4, 1, 2, 1, 2, 0, 3, 4, 0, 1, 2, 1, 2, 0, 1, 2, 1, 2, 1, 0, 2, 3, 4, 0, 1, 2, 0, 3, 0, 4, 3, 4, 1, 2, 1, 2, 0, 3, 4, 1, 2, 0, 0, 0, 0, 0, 1, 2, 1, 2, 0, 3, 0, 4, 3, 4, 1, 2, 0, 3, 4, 1, 2, 0, 3, 4, 1, 2, 3, 4, 0, 1, 2, 1, 2, 0, 3, 4, 3, 4, 5, 3, 4, 1, 2, 0, 3, 4, 3, 4, 3, 4, 1, 2, 1, 2, 1, 2, 0, 0, 0, 0, 0, 1, 2, 1, 2, 1, 2, 0, 3, 4, 3, 4, 3, 0, 4, 0, 1, 2, 0, 0, 3, 4, 3, 4, 3, 4, 0, 0, 3, 4, 1, 2, 5, 6, 0, 0, 1, 2, 1, 2, 0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 3, 4, 1, 0, 2, 3, 4, 1, 2, 0, 1, 2, 1, 2, 0, 3, 4, 3, 4, 3, 4, 0, 1, 2, 1, 2, 1, 2, 0, 6, 1, 0, 2, 3, 4, 1, 2, 0, 3, 4, 0, 0, 3, 4, 0, 3, 4, 1, 2, 0], [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 1, 0, 2, 5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 4, 1, 2, 0, 1, 0, 0, 0, 0, 0, 2, 1, 0, 0, 2, 0, 1, 0, 0, 2, 1, 2, 0, 0, 0, 0, 1, 0, 0, 0, 0, 2, 1, 0, 0, 0, 0, 2, 3, 4, 0, 3, 4, 0, 1, 0, 2, 1, 2, 0, 3, 0, 4, 3, 4, 1, 2, 0, 3, 0, 4, 0, 1, 2, 3, 4, 3, 4, 1, 2, 1, 2, 0, 3, 4, 0, 1, 2, 3, 4, 0, 5, 1, 2, 1, 2, 1, 2, 0, 0, 3, 4, 0, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 0, 1, 2, 1, 1, 2, 0, 2, 1, 0, 2, 1, 2, 0, 6, 3, 0, 4, 1, 2, 1, 0, 0, 0, 0, 2, 1, 2, 0, 1, 2, 0, 1, 2, 3, 4, 1, 2, 1, 0, 0, 2, 3, 4, 0, 1, 1, 2, 2, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 1, 0, 2, 1, 2, 1, 2, 1, 2, 0, 1, 0, 0, 0, 1, 2, 2, 0, 1, 2, 1, 2, 3, 4, 0, 1, 0, 1, 2, 2, 0, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 6], [0, 0, 0, 0, 0, 0, 1, 0, 0, 2, 1, 2, 0, 1, 0, 0, 2, 1, 2, 0, 1, 0, 2, 1, 0, 2, 0, 0, 1, 0, 0, 0, 2, 1, 2, 0, 1, 0, 0, 2, 1, 2, 3, 0, 4, 0, 1, 0, 0, 0, 0, 0, 2, 1, 2, 0, 6, 6, 6, 6, 6, 6, 0, 1, 0, 2, 1, 2, 0, 0, 1, 0, 2, 3, 4, 1, 0, 2, 0, 1, 2, 6, 6, 6, 0, 1, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 1, 0, 0, 2, 3, 4, 0, 6, 0, 1, 0, 0, 2, 0, 1, 0, 0, 2, 1, 0, 0, 2, 1, 0, 2, 1, 0, 2, 0, 1, 0, 2, 1, 0, 2, 0, 1, 2, 3, 4, 1, 2, 0, 0, 0, 0, 0, 0, 6, 3, 0, 4, 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 1, 0, 0, 0, 0, 2], [0, 1, 0, 0, 2, 3, 0, 0, 0, 0, 4, 0, 1, 2, 1, 2, 0, 1, 0, 2, 1, 2, 6, 6, 6, 6, 3, 4, 6, 0, 1, 0, 2, 6, 1, 0, 2, 1, 0, 2, 1, 2, 0, 6, 6, 6, 6, 0, 1, 0, 0, 0, 1, 2, 0, 0, 2, 1, 0, 2, 6, 6, 5, 1, 2, 0, 1, 2, 1, 0, 2, 1, 2, 6, 6, 0, 1, 2, 3, 4, 1, 1, 2, 2, 0, 6, 6, 3, 0, 0, 4, 0, 0, 0, 1, 2, 1, 0, 2, 6, 0, 1, 0, 2, 1, 0, 0, 2, 1, 0, 2, 1, 0, 2, 0, 3, 4, 6, 6, 6, 6, 6, 6, 1, 0, 2, 1, 2, 1, 0, 2, 0, 1, 1, 2, 2, 3, 4, 3, 4, 3, 4, 1, 2, 0, 1, 2, 1, 2, 1, 2, 5, 3, 4, 0, 6, 6, 6, 6, 6, 6, 6, 3, 4, 6, 6, 6, 0, 1, 0, 0, 0, 2, 1, 2, 1, 0, 0, 0, 0, 0, 0, 2, 1, 2, 1, 0, 2, 1, 2, 1, 2, 3, 4, 6, 6, 6, 6, 6, 3, 4, 6, 6, 0, 1, 2, 0, 1, 0, 0, 2, 1, 2, 1, 0, 0, 2, 3, 4, 3, 4, 1, 2, 1, 2, 0, 1, 2, 1, 0, 2, 1, 2, 0], [0, 0, 0, 0, 0, 1, 0, 0, 1, 2, 2, 0, 1, 2, 1, 2, 1, 1, 2, 2, 0, 1, 0, 2, 1, 2, 0, 1, 0, 2, 1, 2, 0, 1, 2, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 0, 0, 0, 0, 1, 0, 0, 0, 2, 1, 2, 0, 0, 1, 2, 0, 1, 2, 0, 1, 2, 3, 4, 3, 4, 0, 0, 0, 0, 0, 1, 0, 0, 2, 1, 2, 0, 1, 2, 1, 0, 0, 0, 2, 1, 2, 0, 0, 1, 2, 1, 2, 1, 2, 0, 0, 0, 0, 1, 2, 1, 2, 0, 1, 2, 1, 2, 1, 0, 1, 2, 2, 0, 0, 0, 0], [0, 1, 2, 1, 2, 1, 2, 1, 2, 3, 4, 1, 2, 1, 2, 1, 2, 3, 4, 1, 2, 3, 4, 3, 4, 1, 2, 1, 2, 3, 4, 3, 4, 1, 2, 1, 2, 0, 0, 1, 1, 2, 2, 1, 2, 3, 4, 1, 2, 1, 2, 1, 2, 1, 2, 0, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 6, 3, 4, 6, 6, 3, 4, 1, 2, 5, 3, 4, 1, 5, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2], [0, 0, 0, 0, 0, 0, 0, 1, 2, 3, 4, 1, 2, 0, 3, 4, 1, 2, 0, 3, 0, 0, 4, 1, 2, 3, 4, 0, 3, 0, 4, 3, 4, 0, 1, 0, 0, 1, 2, 2, 0, 1, 2, 6, 3, 4, 0, 1, 2, 1, 2, 6, 6, 6, 6, 6, 0, 3, 4, 0, 0, 1, 0, 0, 0, 1, 2, 2, 0, 3, 4, 6, 0, 1, 2, 1, 2, 0, 0, 1, 2, 1, 0, 0, 0, 0, 0, 0, 0, 2, 1, 2, 0, 1, 2, 0, 1, 2, 1, 0, 2, 1, 2, 0, 1, 2, 0, 1, 2, 0, 1, 2, 3, 4, 0, 1, 2, 1, 2, 0, 0, 1, 2, 1, 2, 6, 6, 6, 6, 0, 0, 3, 4, 3, 4, 3, 4, 1, 0, 2, 1, 2, 0, 1, 0, 1, 2, 2, 1, 2, 0, 1, 2, 1, 2, 1, 0, 2, 1, 2, 0, 1, 2, 1, 0, 0, 1, 2, 2, 0, 1, 2, 0, 0, 0, 1, 2, 1, 0, 0, 2, 1, 2, 0, 1, 0, 2, 1, 2, 1, 2, 1, 2, 0, 0, 1, 1, 2, 2, 0, 1, 2, 0, 3, 4], [0, 0, 0, 0, 0, 1, 0, 0, 2, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 1, 2, 0, 1, 0, 2, 3, 4, 1, 2, 0, 3, 4, 3, 4, 0, 1, 2, 0, 1, 1, 2, 2, 0, 1, 2, 0, 1, 2, 0, 0, 1, 0, 0, 2, 1, 0, 2, 3, 4, 0, 3, 4, 0, 1, 0, 0, 0, 0, 2, 1, 0, 2, 0, 1, 0, 0, 2, 1, 2, 0, 0, 1, 2, 1, 0, 2, 3, 4, 3, 0, 0, 4, 0, 3, 4, 1, 2, 0, 1, 2, 0, 1, 2, 1, 0, 2, 0, 3, 4, 1, 0, 2, 0, 1, 2, 1, 0, 2, 1, 2, 0, 1, 2, 0, 1, 2, 3, 4, 3, 4, 0, 0, 0, 1, 0, 2, 1, 2, 1, 2, 0, 1, 2, 1, 2, 3, 4, 1, 2, 1, 2, 0, 0]]
Expert1LengthsSE = [152, 242, 236, 258, 174, 234, 123, 90, 205, 154]
Expert2StartEnd = [[0, 0, 0, 3, 4, 3, 0, 0, 4, 3, 4, 3, 0, 4, 0, 3, 0, 0, 0, 4, 3, 0, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 3, 0, 4, 3, 0, 4, 0], [0, 3, 4, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 3, 4, 3, 4, 3, 4, 3, 4, 0, 0, 0, 0, 3, 4, 5, 3, 4, 0, 0, 3, 0, 4, 0, 0, 3, 4, 0, 3, 4, 0, 0, 0, 0, 0, 3, 4, 3, 4, 3, 4, 1, 2, 3, 4, 0, 0, 0, 0, 0, 3, 4, 3, 4, 0], [0, 3, 4, 0, 0, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 6, 3, 4, 0, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 0, 6, 0, 3, 4, 3, 4, 6, 3, 4, 0, 0, 3, 4, 0, 3, 4, 6, 0, 0, 0, 0, 3, 4, 3, 4, 3, 4, 0, 0, 3, 4, 1, 2, 0, 1, 2, 0, 1, 2, 1, 5, 3, 4, 0, 1, 2, 0, 1, 2], [0, 3, 0, 0, 0, 0, 4, 3, 4, 0, 3, 0, 0, 0, 0, 0, 0, 0, 4, 0, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 0, 0, 4, 3, 4, 3, 4, 0, 3, 4, 0, 1, 2, 3, 4, 5, 3, 4, 3, 4, 3, 4, 5, 0, 5, 5, 1, 2, 0, 0, 3, 4, 0, 0, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 3, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 5, 3, 4, 0], [0, 0, 0, 3, 4, 0, 3, 0, 4, 3, 0, 4, 0, 3, 4, 0, 3, 4, 0, 0, 0, 3, 4, 0, 0, 3, 0, 4, 0, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 0, 0, 3, 0, 4, 0, 3, 0, 4, 0, 3, 0, 0, 0, 0, 4, 3, 4, 3, 4, 3, 0, 4, 5, 3, 0, 4, 0, 0, 3, 0, 4, 0, 0, 0], [0, 3, 0, 4, 3, 4, 3, 0, 4, 0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 3, 0, 4, 3, 0, 4, 0, 3, 0, 4, 3, 4, 3, 4, 3, 0, 4, 3, 4, 0, 3, 0, 4, 3, 4, 3, 4, 5, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 0, 3, 0, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 0, 4, 0, 3, 4, 0, 0, 3, 4, 3, 0, 4, 3, 0, 0, 0, 4, 3, 4, 5, 1, 2, 3, 0, 4, 3, 0, 4, 3, 4, 3, 4, 0], [0, 3, 0, 0, 0, 0, 0, 4, 3, 4, 0, 3, 4, 0, 3, 0, 4, 0, 3, 4, 0, 3, 0, 4, 3, 4, 3, 4, 0, 3, 4, 0, 3, 0, 4, 3, 4, 1, 0, 2, 0, 0, 0, 0, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 3, 4, 3, 4, 3, 4, 0], [0, 0, 6, 6, 6, 1, 2, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 1, 2, 1, 2, 3, 4, 6, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 1, 2, 3, 4, 3, 4, 1, 2, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 1, 2, 3, 4, 5], [0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 3, 0, 4, 0, 3, 4, 0, 0, 3, 4, 3, 0, 0, 4, 5, 0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 1, 1, 2, 2, 6, 0, 0, 0, 3, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 0, 3, 0, 4, 0, 0, 0], [0, 3, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 3, 0, 4, 0, 3, 4, 0, 3, 0, 4, 0, 3, 4, 3, 0, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 0, 3, 4, 3, 4, 5, 3, 4, 3, 4, 0, 0, 3, 0, 4, 3, 4, 3, 4, 0]]
Expert2LengthsSE = [40, 71, 96, 129, 74, 121, 64, 81, 62, 59]
Intermediate1StartEnd = [[0, 0, 0, 0, 1, 0, 0, 2, 1, 0, 2, 1, 0, 2, 3, 4, 1, 2, 3, 4, 6, 3, 4, 0, 3, 4, 0, 3, 4, 5, 3, 4, 0, 3, 4, 1, 2, 1, 2, 1, 2, 1, 2, 3, 4, 6, 0, 3, 4, 0, 1, 2, 6, 1, 2, 0, 0, 3, 4, 1, 2, 0, 3, 4, 0, 3, 4, 1, 2, 1, 2, 0, 0, 3, 4, 1, 0, 2, 3, 4, 0, 3, 4, 3, 4, 3, 0, 4, 0, 1, 2, 1, 2, 5, 3, 4, 3, 4, 3, 4, 3, 4, 0, 1, 2, 1, 2, 6, 3, 4, 0, 1, 2, 0, 1, 2, 0, 5, 0, 3, 4, 3, 4, 6, 6, 6, 6, 6, 6, 3, 4, 0, 5, 3, 4, 3, 4, 6, 6, 3, 4, 3, 4, 0, 0, 1, 2, 1, 0, 2, 3, 4, 3, 4, 3, 4, 6, 1, 2, 1, 2, 6, 6, 1, 2, 1, 2, 6, 6, 6, 6, 6, 6, 3, 4, 3, 4, 3, 4, 3, 0, 4, 3, 4, 3, 4, 3, 4, 1, 0, 2, 1, 0, 2, 3, 4, 3, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 0, 1, 2, 1, 0, 0, 2, 1, 2, 0, 3, 4, 1, 2, 0, 3, 4, 1, 0, 2, 6, 3, 4, 0, 3, 4, 1, 2, 1, 2, 0, 3, 4, 1, 2, 6, 6, 1, 2, 3, 4, 0, 3, 4, 3, 4, 3, 4, 1, 2, 1, 2, 0, 3, 4, 6, 6], [0, 0, 0, 0, 0, 0, 1, 2, 1, 1, 2, 2, 1, 3, 4, 2, 1, 2, 0, 1, 2, 1, 2, 1, 2, 0, 3, 0, 0, 4, 3, 4, 1, 2, 1, 0, 0, 2, 1, 2, 0, 3, 4, 3, 4, 0, 1, 0, 0, 2, 3, 4, 3, 4, 1, 2, 6, 0, 0, 1, 2, 1, 2, 1, 2, 1, 2, 0, 0, 1, 0, 0, 2], [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 2, 3, 0, 0, 0, 4, 3, 0, 4, 3, 0, 0, 0, 0, 0, 0, 0, 4, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 1, 0, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 1, 0, 2, 3, 0, 4, 0, 3, 4, 6, 6, 5, 3, 4, 3, 4, 5, 3, 0, 0, 0, 0, 4, 3, 4, 3, 0, 0, 0, 0, 0, 4, 3, 4, 3, 4, 1, 2, 3, 4, 0, 3, 4, 3, 4, 6, 3, 4, 1, 2, 3, 4, 3, 4, 3, 4, 1, 2, 1, 0, 2, 0, 0, 3, 0, 0, 0, 4], [0, 1, 0, 0, 0, 0, 0, 2, 3, 0, 0, 0, 0, 4, 1, 2, 0, 1, 0, 0, 0, 2, 3, 4, 1, 2, 3, 4, 1, 0, 0, 0, 2, 1, 0, 2, 3, 4, 1, 0, 1, 2, 2, 0, 0, 0, 1, 0, 0, 0, 0, 2, 3, 4, 1, 0, 2, 1, 2, 1, 2, 0, 1, 2, 1, 1, 2, 0, 2, 1, 2, 0, 1, 0, 2, 1, 2, 0, 1, 1, 2, 2, 3, 4, 1, 2, 1, 2, 0, 0, 0], [0, 1, 0, 0, 0, 0, 0, 0, 0, 2, 1, 2, 0, 1, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 1, 2, 0, 1, 0, 2, 3, 4, 3, 0, 0, 4, 3, 4, 0, 0, 0, 0, 1, 2, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 1, 2, 0, 1, 0, 2, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 1, 0, 0, 3, 2, 4, 5, 3, 4, 3, 4, 3, 0, 0, 0, 4, 1, 2, 1, 0, 2, 1, 2, 0, 0, 0, 1, 0, 0, 0, 0, 2, 3, 4, 0, 1, 0, 2, 3, 0, 4, 1, 0, 2, 3, 4, 0, 1, 2, 3, 4, 6, 3, 4, 3, 4, 6, 3, 4, 3, 4, 1, 2, 0, 0, 3, 0, 0, 4, 3, 4, 1, 0, 2, 1, 2, 3, 4, 6, 3, 4, 0, 0, 3, 4, 3, 4, 3, 4, 3, 4, 1, 2, 1, 2, 0, 3, 4, 0, 0, 0, 1, 2], [0, 0, 0, 0, 0, 0, 1, 0, 0, 2, 1, 2, 1, 0, 0, 0, 2, 1, 2, 3, 4, 3, 4, 3, 4, 0, 1, 2, 1, 2, 6, 1, 2, 5, 0, 0, 1, 2, 1, 0, 2, 3, 0, 4, 5, 1, 0, 2, 1, 2, 0, 0, 0, 1, 2, 3, 4, 1, 2, 0, 3, 4, 3, 4, 0, 1, 0, 2, 1, 2, 0, 3, 4, 0, 1, 0, 2, 1, 2, 0, 1, 2, 1, 2, 0, 3, 4, 3, 4, 5, 5, 1, 0, 2, 1, 2, 0, 0, 1, 2, 1, 0, 0, 0, 2], [0, 0, 0, 0, 1, 0, 0, 0, 0, 2, 1, 2, 0, 3, 4, 1, 2, 0, 1, 0, 2, 0, 3, 4, 3, 4, 0, 3, 4, 1, 0, 2, 1, 2, 1, 2, 3, 4, 3, 4, 3, 4, 0, 1, 2, 0, 1, 2, 0, 1, 2, 0, 3, 4, 1, 2, 3, 4, 3, 4, 0, 1, 2, 0, 1, 2, 1, 2, 1, 2, 1, 0, 2, 1, 2, 1, 2, 0, 0, 1, 0, 2, 1, 0, 0, 2, 3, 0, 0, 4, 5, 1, 2, 6, 0, 1, 2, 1, 0, 0, 2, 3, 4, 1, 2, 0, 0, 0, 1, 2, 3, 4, 3, 4], [0, 0, 0, 0, 1, 0, 0, 0, 0, 2, 1, 2, 1, 0, 2, 0, 1, 0, 0, 0, 0, 1, 2, 2, 0, 1, 0, 0, 0, 2, 1, 0, 2, 0, 6, 3, 4, 0, 3, 0, 0, 0, 0, 4, 1, 0, 0, 2, 1, 2, 0, 3, 0, 0, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 3, 4, 1, 0, 1, 2, 2, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 1, 0, 0, 2, 3, 4, 0, 1, 0, 0, 2, 3, 4, 0, 1, 0, 0, 2, 1, 0, 2, 1, 0, 2, 3, 4, 1, 0, 2, 1, 2], [0, 0, 0, 0, 0, 1, 1, 2, 0, 2, 0, 1, 2, 0, 1, 2, 3, 0, 4, 1, 2, 0, 0, 1, 0, 1, 2, 2, 1, 1, 2, 0, 2, 0, 0, 1, 2, 1, 0, 2, 1, 0, 2, 1, 0, 1, 2, 2, 1, 2, 0, 1, 0, 0, 2, 1, 2, 0, 1, 0, 0, 2, 1, 1, 2, 0, 2, 0, 0, 3, 4, 1, 2, 0, 1, 1, 2, 2, 0, 0, 0, 0, 1, 2, 1, 0, 0, 0, 2, 1, 2, 0, 0, 3, 4, 1, 0, 2, 1, 0, 2, 1, 0, 2, 1, 0, 2, 0, 3, 4, 3, 4, 1, 2, 1, 2, 1, 0, 0, 2, 0, 3, 4, 1, 2, 1, 2, 1, 2, 1, 0, 2, 1, 2, 1, 2, 0, 0, 0, 1, 2, 1, 2, 1, 2, 0, 1, 0, 0, 2, 1, 2, 3, 4, 3, 0, 4]]
Intermediate1LengthsSE = [271, 73, 130, 91, 186, 105, 114, 118, 157]
Intermediate2StartEnd = [[0, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 0, 0, 1, 0, 0, 2, 5, 1, 2, 3, 4, 3, 4, 5, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 0, 5, 3, 4, 1, 2, 1, 2, 6, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 3, 4, 6, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 3, 4], [0, 0, 3, 4, 3, 4, 3, 4, 3, 0, 4, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 0], [0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 3, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 0, 4, 0, 0, 3, 0, 4, 0, 3, 0, 4, 0], [0, 3, 0, 0, 0, 0, 0, 4, 3, 4, 3, 0, 4, 3, 4, 0, 3, 4, 0, 3, 0, 0, 0, 4, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 0, 0, 3, 4, 3, 4, 3, 0, 4, 3, 4, 5, 5, 0, 3, 4, 3, 0, 4, 3, 4, 3, 4, 0, 3, 4], [0, 3, 4, 0, 3, 4, 0, 3, 0, 0, 0, 0, 0, 4, 0, 0, 3, 4, 3, 4, 3, 4, 3, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 4, 0, 3, 0, 0, 4, 3, 4, 0, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 0, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 4, 0, 3, 0, 4, 0, 0, 0, 3, 4], [0, 3, 4, 0, 0, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 0, 3, 4, 0, 3, 4, 0, 0], [0, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 3, 4, 3, 0, 4, 0, 0, 3, 4, 0, 0, 3, 0, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 1, 2, 0, 3, 4, 0], [0, 3, 4, 0, 0, 0, 0, 3, 4, 3, 4, 0, 3, 4, 3, 0, 4, 0, 0, 3, 0, 0, 0, 4, 3, 4, 3, 4, 1, 2, 3, 4, 5, 3, 4, 3, 4, 3, 4, 0, 3, 0, 4, 0, 3, 4, 0, 3, 0, 4, 3, 4, 0, 0, 3, 0, 4, 0, 0, 0], [0, 3, 4, 3, 0, 4, 0, 3, 4, 0, 3, 4, 3, 0, 4, 0, 3, 4, 0, 3, 0, 4, 3, 4, 0, 3, 0, 0, 0, 4, 0, 3, 4, 3, 4, 0, 0, 0, 3, 4, 3, 0, 4, 0, 3, 4, 0]]
Intermediate2LengthsSE = [117, 26, 53, 60, 80, 27, 60, 60, 47]

allTask1Combined = [[0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 2, 1, 0, 2, 6, 6, 1, 2, 0, 0, 0, 3, 4, 3, 4, 3, 4, 1, 0, 0, 0, 0, 2, 1, 2, 1, 0, 0, 2, 1, 0, 2, 6, 1, 0, 0, 0, 0, 0, 0, 1, 2, 0, 2, 1, 0, 0, 2, 1, 2, 1, 2, 6, 6, 0, 0, 3, 4, 6, 1, 0, 0, 2, 0, 0, 6, 3, 0, 4, 1, 2, 1, 0, 0, 0, 2, 3, 4, 1, 2, 1, 0, 2, 1, 2, 1, 2, 6, 3, 4, 3, 4, 3, 4, 3, 4, 1, 2, 3, 4, 1, 2, 6, 0, 0, 0, 1, 0, 0, 0, 0, 0, 2, 1, 0, 2, 1, 2, 1, 0, 0, 0, 2, 1, 2, 6, 6, 3, 4, 0, 3, 4, 3, 4, 1, 0, 2, 0, 0], [0, 0, 0, 0, 0, 0, 1, 2, 0, 3, 0, 4, 3, 4, 0, 3, 0, 4, 3, 4, 1, 2, 0, 0, 1, 2, 1, 2, 0, 3, 4, 1, 2, 1, 2, 1, 2, 1, 2, 0, 1, 0, 2, 0, 3, 4, 1, 2, 0, 1, 2, 1, 2, 1, 2, 6, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 1, 2, 0, 3, 4, 3, 4, 1, 0, 2, 1, 2, 0, 0, 0, 0, 1, 2, 1, 2, 0, 1, 2, 3, 4, 0, 1, 2, 1, 2, 1, 2, 1, 2, 0, 6, 1, 2, 0, 3, 4, 1, 2, 1, 2, 0, 0, 3, 4, 3, 4, 5, 3, 4, 3, 4, 0, 1, 2, 1, 2, 0, 3, 4, 1, 2, 0, 0, 3, 4, 0, 0, 0, 0, 1, 1, 2, 2, 0, 3, 4, 0, 0, 0, 0, 0, 0, 1, 2, 0, 3, 4, 1, 2, 3, 4, 0, 3, 4, 0, 3, 4, 1, 2, 0, 1, 2, 1, 2, 0, 1, 2, 1, 2, 1, 2, 0, 0, 0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 0, 0, 0, 0, 0, 1, 2, 0, 1, 2, 3, 4, 3, 4, 6, 6, 3, 4, 3, 4, 3, 4, 0, 1, 1, 2, 0, 2, 0, 1, 2, 0, 3, 4, 1, 2, 1, 2, 0, 3, 4, 3, 4, 1, 2, 5, 0, 0], [0, 1, 2, 0, 3, 4, 1, 2, 0, 3, 4, 1, 2, 1, 2, 0, 3, 4, 0, 1, 2, 1, 0, 2, 1, 2, 0, 0, 5, 1, 2, 0, 5, 3, 4, 1, 2, 1, 2, 0, 3, 4, 0, 1, 2, 1, 2, 0, 1, 2, 1, 2, 1, 0, 2, 3, 4, 0, 1, 2, 0, 3, 0, 4, 3, 4, 1, 2, 1, 2, 0, 3, 4, 1, 2, 0, 0, 0, 0, 0, 1, 2, 1, 2, 0, 3, 0, 4, 3, 4, 1, 2, 0, 3, 4, 1, 2, 0, 3, 4, 1, 2, 3, 4, 0, 1, 2, 1, 2, 0, 3, 4, 3, 4, 5, 3, 4, 1, 2, 0, 3, 4, 3, 4, 3, 4, 1, 2, 1, 2, 1, 2, 0, 0, 0, 0, 0, 1, 2, 1, 2, 1, 2, 0, 3, 4, 3, 4, 3, 0, 4, 0, 1, 2, 0, 0, 3, 4, 3, 4, 3, 4, 0, 0, 3, 4, 1, 2, 5, 6, 0, 0, 1, 2, 1, 2, 0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 3, 4, 1, 0, 2, 3, 4, 1, 2, 0, 1, 2, 1, 2, 0, 3, 4, 3, 4, 3, 4, 0, 1, 2, 1, 2, 1, 2, 0, 6, 1, 0, 2, 3, 4, 1, 2, 0, 3, 4, 0, 0, 3, 4, 0, 3, 4, 1, 2, 0], [0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 1, 0, 2, 5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 4, 1, 2, 0, 1, 0, 0, 0, 0, 0, 2, 1, 0, 0, 2, 0, 1, 0, 0, 2, 1, 2, 0, 0, 0, 0, 1, 0, 0, 0, 0, 2, 1, 0, 0, 0, 0, 2, 3, 4, 0, 3, 4, 0, 1, 0, 2, 1, 2, 0, 3, 0, 4, 3, 4, 1, 2, 0, 3, 0, 4, 0, 1, 2, 3, 4, 3, 4, 1, 2, 1, 2, 0, 3, 4, 0, 1, 2, 3, 4, 0, 5, 1, 2, 1, 2, 1, 2, 0, 0, 3, 4, 0, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 0, 1, 2, 1, 1, 2, 0, 2, 1, 0, 2, 1, 2, 0, 6, 3, 0, 4, 1, 2, 1, 0, 0, 0, 0, 2, 1, 2, 0, 1, 2, 0, 1, 2, 3, 4, 1, 2, 1, 0, 0, 2, 3, 4, 0, 1, 1, 2, 2, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 1, 0, 2, 1, 2, 1, 2, 1, 2, 0, 1, 0, 0, 0, 1, 2, 2, 0, 1, 2, 1, 2, 3, 4, 0, 1, 0, 1, 2, 2, 0, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 6], [0, 0, 0, 0, 0, 0, 1, 0, 0, 2, 1, 2, 0, 1, 0, 0, 2, 1, 2, 0, 1, 0, 2, 1, 0, 2, 0, 0, 1, 0, 0, 0, 2, 1, 2, 0, 1, 0, 0, 2, 1, 2, 3, 0, 4, 0, 1, 0, 0, 0, 0, 0, 2, 1, 2, 0, 6, 6, 6, 6, 6, 6, 0, 1, 0, 2, 1, 2, 0, 0, 1, 0, 2, 3, 4, 1, 0, 2, 0, 1, 2, 6, 6, 6, 0, 1, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 1, 0, 0, 2, 3, 4, 0, 6, 0, 1, 0, 0, 2, 0, 1, 0, 0, 2, 1, 0, 0, 2, 1, 0, 2, 1, 0, 2, 0, 1, 0, 2, 1, 0, 2, 0, 1, 2, 3, 4, 1, 2, 0, 0, 0, 0, 0, 0, 6, 3, 0, 4, 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 1, 0, 0, 0, 0, 2], [0, 1, 0, 0, 2, 3, 0, 0, 0, 0, 4, 0, 1, 2, 1, 2, 0, 1, 0, 2, 1, 2, 6, 6, 6, 6, 3, 4, 6, 0, 1, 0, 2, 6, 1, 0, 2, 1, 0, 2, 1, 2, 0, 6, 6, 6, 6, 0, 1, 0, 0, 0, 1, 2, 0, 0, 2, 1, 0, 2, 6, 6, 5, 1, 2, 0, 1, 2, 1, 0, 2, 1, 2, 6, 6, 0, 1, 2, 3, 4, 1, 1, 2, 2, 0, 6, 6, 3, 0, 0, 4, 0, 0, 0, 1, 2, 1, 0, 2, 6, 0, 1, 0, 2, 1, 0, 0, 2, 1, 0, 2, 1, 0, 2, 0, 3, 4, 6, 6, 6, 6, 6, 6, 1, 0, 2, 1, 2, 1, 0, 2, 0, 1, 1, 2, 2, 3, 4, 3, 4, 3, 4, 1, 2, 0, 1, 2, 1, 2, 1, 2, 5, 3, 4, 0, 6, 6, 6, 6, 6, 6, 6, 3, 4, 6, 6, 6, 0, 1, 0, 0, 0, 2, 1, 2, 1, 0, 0, 0, 0, 0, 0, 2, 1, 2, 1, 0, 2, 1, 2, 1, 2, 3, 4, 6, 6, 6, 6, 6, 3, 4, 6, 6, 0, 1, 2, 0, 1, 0, 0, 2, 1, 2, 1, 0, 0, 2, 3, 4, 3, 4, 1, 2, 1, 2, 0, 1, 2, 1, 0, 2, 1, 2, 0], [0, 0, 0, 0, 0, 1, 0, 0, 1, 2, 2, 0, 1, 2, 1, 2, 1, 1, 2, 2, 0, 1, 0, 2, 1, 2, 0, 1, 0, 2, 1, 2, 0, 1, 2, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2, 3, 4, 0, 0, 0, 0, 1, 0, 0, 0, 2, 1, 2, 0, 0, 1, 2, 0, 1, 2, 0, 1, 2, 3, 4, 3, 4, 0, 0, 0, 0, 0, 1, 0, 0, 2, 1, 2, 0, 1, 2, 1, 0, 0, 0, 2, 1, 2, 0, 0, 1, 2, 1, 2, 1, 2, 0, 0, 0, 0, 1, 2, 1, 2, 0, 1, 2, 1, 2, 1, 0, 1, 2, 2, 0, 0, 0, 0], [0, 1, 2, 1, 2, 1, 2, 1, 2, 3, 4, 1, 2, 1, 2, 1, 2, 3, 4, 1, 2, 3, 4, 3, 4, 1, 2, 1, 2, 3, 4, 3, 4, 1, 2, 1, 2, 0, 0, 1, 1, 2, 2, 1, 2, 3, 4, 1, 2, 1, 2, 1, 2, 1, 2, 0, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 6, 3, 4, 6, 6, 3, 4, 1, 2, 5, 3, 4, 1, 5, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2], [0, 0, 0, 0, 0, 0, 0, 1, 2, 3, 4, 1, 2, 0, 3, 4, 1, 2, 0, 3, 0, 0, 4, 1, 2, 3, 4, 0, 3, 0, 4, 3, 4, 0, 1, 0, 0, 1, 2, 2, 0, 1, 2, 6, 3, 4, 0, 1, 2, 1, 2, 6, 6, 6, 6, 6, 0, 3, 4, 0, 0, 1, 0, 0, 0, 1, 2, 2, 0, 3, 4, 6, 0, 1, 2, 1, 2, 0, 0, 1, 2, 1, 0, 0, 0, 0, 0, 0, 0, 2, 1, 2, 0, 1, 2, 0, 1, 2, 1, 0, 2, 1, 2, 0, 1, 2, 0, 1, 2, 0, 1, 2, 3, 4, 0, 1, 2, 1, 2, 0, 0, 1, 2, 1, 2, 6, 6, 6, 6, 0, 0, 3, 4, 3, 4, 3, 4, 1, 0, 2, 1, 2, 0, 1, 0, 1, 2, 2, 1, 2, 0, 1, 2, 1, 2, 1, 0, 2, 1, 2, 0, 1, 2, 1, 0, 0, 1, 2, 2, 0, 1, 2, 0, 0, 0, 1, 2, 1, 0, 0, 2, 1, 2, 0, 1, 0, 2, 1, 2, 1, 2, 1, 2, 0, 0, 1, 1, 2, 2, 0, 1, 2, 0, 3, 4], [0, 0, 0, 0, 0, 1, 0, 0, 2, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 1, 2, 0, 1, 0, 2, 3, 4, 1, 2, 0, 3, 4, 3, 4, 0, 1, 2, 0, 1, 1, 2, 2, 0, 1, 2, 0, 1, 2, 0, 0, 1, 0, 0, 2, 1, 0, 2, 3, 4, 0, 3, 4, 0, 1, 0, 0, 0, 0, 2, 1, 0, 2, 0, 1, 0, 0, 2, 1, 2, 0, 0, 1, 2, 1, 0, 2, 3, 4, 3, 0, 0, 4, 0, 3, 4, 1, 2, 0, 1, 2, 0, 1, 2, 1, 0, 2, 0, 3, 4, 1, 0, 2, 0, 1, 2, 1, 0, 2, 1, 2, 0, 1, 2, 0, 1, 2, 3, 4, 3, 4, 0, 0, 0, 1, 0, 2, 1, 2, 1, 2, 0, 1, 2, 1, 2, 3, 4, 1, 2, 1, 2, 0, 0], [0, 0, 0, 0, 1, 0, 0, 2, 1, 0, 2, 1, 0, 2, 3, 4, 1, 2, 3, 4, 6, 3, 4, 0, 3, 4, 0, 3, 4, 5, 3, 4, 0, 3, 4, 1, 2, 1, 2, 1, 2, 1, 2, 3, 4, 6, 0, 3, 4, 0, 1, 2, 6, 1, 2, 0, 0, 3, 4, 1, 2, 0, 3, 4, 0, 3, 4, 1, 2, 1, 2, 0, 0, 3, 4, 1, 0, 2, 3, 4, 0, 3, 4, 3, 4, 3, 0, 4, 0, 1, 2, 1, 2, 5, 3, 4, 3, 4, 3, 4, 3, 4, 0, 1, 2, 1, 2, 6, 3, 4, 0, 1, 2, 0, 1, 2, 0, 5, 0, 3, 4, 3, 4, 6, 6, 6, 6, 6, 6, 3, 4, 0, 5, 3, 4, 3, 4, 6, 6, 3, 4, 3, 4, 0, 0, 1, 2, 1, 0, 2, 3, 4, 3, 4, 3, 4, 6, 1, 2, 1, 2, 6, 6, 1, 2, 1, 2, 6, 6, 6, 6, 6, 6, 3, 4, 3, 4, 3, 4, 3, 0, 4, 3, 4, 3, 4, 3, 4, 1, 0, 2, 1, 0, 2, 3, 4, 3, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 0, 1, 2, 1, 0, 0, 2, 1, 2, 0, 3, 4, 1, 2, 0, 3, 4, 1, 0, 2, 6, 3, 4, 0, 3, 4, 1, 2, 1, 2, 0, 3, 4, 1, 2, 6, 6, 1, 2, 3, 4, 0, 3, 4, 3, 4, 3, 4, 1, 2, 1, 2, 0, 3, 4, 6, 6], [0, 0, 0, 0, 0, 0, 1, 2, 1, 1, 2, 2, 1, 3, 4, 2, 1, 2, 0, 1, 2, 1, 2, 1, 2, 0, 3, 0, 0, 4, 3, 4, 1, 2, 1, 0, 0, 2, 1, 2, 0, 3, 4, 3, 4, 0, 1, 0, 0, 2, 3, 4, 3, 4, 1, 2, 6, 0, 0, 1, 2, 1, 2, 1, 2, 1, 2, 0, 0, 1, 0, 0, 2], [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 2, 3, 0, 0, 0, 4, 3, 0, 4, 3, 0, 0, 0, 0, 0, 0, 0, 4, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 1, 0, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 1, 0, 2, 3, 0, 4, 0, 3, 4, 6, 6, 5, 3, 4, 3, 4, 5, 3, 0, 0, 0, 0, 4, 3, 4, 3, 0, 0, 0, 0, 0, 4, 3, 4, 3, 4, 1, 2, 3, 4, 0, 3, 4, 3, 4, 6, 3, 4, 1, 2, 3, 4, 3, 4, 3, 4, 1, 2, 1, 0, 2, 0, 0, 3, 0, 0, 0, 4], [0, 1, 0, 0, 0, 0, 0, 2, 3, 0, 0, 0, 0, 4, 1, 2, 0, 1, 0, 0, 0, 2, 3, 4, 1, 2, 3, 4, 1, 0, 0, 0, 2, 1, 0, 2, 3, 4, 1, 0, 1, 2, 2, 0, 0, 0, 1, 0, 0, 0, 0, 2, 3, 4, 1, 0, 2, 1, 2, 1, 2, 0, 1, 2, 1, 1, 2, 0, 2, 1, 2, 0, 1, 0, 2, 1, 2, 0, 1, 1, 2, 2, 3, 4, 1, 2, 1, 2, 0, 0, 0], [0, 1, 0, 0, 0, 0, 0, 0, 0, 2, 1, 2, 0, 1, 2, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 1, 2, 0, 1, 0, 2, 3, 4, 3, 0, 0, 4, 3, 4, 0, 0, 0, 0, 1, 2, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 1, 2, 0, 1, 0, 2, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 1, 0, 0, 3, 2, 4, 5, 3, 4, 3, 4, 3, 0, 0, 0, 4, 1, 2, 1, 0, 2, 1, 2, 0, 0, 0, 1, 0, 0, 0, 0, 2, 3, 4, 0, 1, 0, 2, 3, 0, 4, 1, 0, 2, 3, 4, 0, 1, 2, 3, 4, 6, 3, 4, 3, 4, 6, 3, 4, 3, 4, 1, 2, 0, 0, 3, 0, 0, 4, 3, 4, 1, 0, 2, 1, 2, 3, 4, 6, 3, 4, 0, 0, 3, 4, 3, 4, 3, 4, 3, 4, 1, 2, 1, 2, 0, 3, 4, 0, 0, 0, 1, 2], [0, 0, 0, 0, 0, 0, 1, 0, 0, 2, 1, 2, 1, 0, 0, 0, 2, 1, 2, 3, 4, 3, 4, 3, 4, 0, 1, 2, 1, 2, 6, 1, 2, 5, 0, 0, 1, 2, 1, 0, 2, 3, 0, 4, 5, 1, 0, 2, 1, 2, 0, 0, 0, 1, 2, 3, 4, 1, 2, 0, 3, 4, 3, 4, 0, 1, 0, 2, 1, 2, 0, 3, 4, 0, 1, 0, 2, 1, 2, 0, 1, 2, 1, 2, 0, 3, 4, 3, 4, 5, 5, 1, 0, 2, 1, 2, 0, 0, 1, 2, 1, 0, 0, 0, 2], [0, 0, 0, 0, 1, 0, 0, 0, 0, 2, 1, 2, 0, 3, 4, 1, 2, 0, 1, 0, 2, 0, 3, 4, 3, 4, 0, 3, 4, 1, 0, 2, 1, 2, 1, 2, 3, 4, 3, 4, 3, 4, 0, 1, 2, 0, 1, 2, 0, 1, 2, 0, 3, 4, 1, 2, 3, 4, 3, 4, 0, 1, 2, 0, 1, 2, 1, 2, 1, 2, 1, 0, 2, 1, 2, 1, 2, 0, 0, 1, 0, 2, 1, 0, 0, 2, 3, 0, 0, 4, 5, 1, 2, 6, 0, 1, 2, 1, 0, 0, 2, 3, 4, 1, 2, 0, 0, 0, 1, 2, 3, 4, 3, 4], [0, 0, 0, 0, 1, 0, 0, 0, 0, 2, 1, 2, 1, 0, 2, 0, 1, 0, 0, 0, 0, 1, 2, 2, 0, 1, 0, 0, 0, 2, 1, 0, 2, 0, 6, 3, 4, 0, 3, 0, 0, 0, 0, 4, 1, 0, 0, 2, 1, 2, 0, 3, 0, 0, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 3, 4, 1, 0, 1, 2, 2, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 2, 1, 0, 0, 2, 3, 4, 0, 1, 0, 0, 2, 3, 4, 0, 1, 0, 0, 2, 1, 0, 2, 1, 0, 2, 3, 4, 1, 0, 2, 1, 2], [0, 0, 0, 0, 0, 1, 1, 2, 0, 2, 0, 1, 2, 0, 1, 2, 3, 0, 4, 1, 2, 0, 0, 1, 0, 1, 2, 2, 1, 1, 2, 0, 2, 0, 0, 1, 2, 1, 0, 2, 1, 0, 2, 1, 0, 1, 2, 2, 1, 2, 0, 1, 0, 0, 2, 1, 2, 0, 1, 0, 0, 2, 1, 1, 2, 0, 2, 0, 0, 3, 4, 1, 2, 0, 1, 1, 2, 2, 0, 0, 0, 0, 1, 2, 1, 0, 0, 0, 2, 1, 2, 0, 0, 3, 4, 1, 0, 2, 1, 0, 2, 1, 0, 2, 1, 0, 2, 0, 3, 4, 3, 4, 1, 2, 1, 2, 1, 0, 0, 2, 0, 3, 4, 1, 2, 1, 2, 1, 2, 1, 0, 2, 1, 2, 1, 2, 0, 0, 0, 1, 2, 1, 2, 1, 2, 0, 1, 0, 0, 2, 1, 2, 3, 4, 3, 0, 4]]
allTask1CombinedLengths = [152, 242, 236, 258, 174, 234, 123, 90, 205, 154, 271, 73, 130, 91, 186, 105, 114, 118, 157]
allTask2Combined = [[0, 0, 0, 3, 4, 3, 0, 0, 4, 3, 4, 3, 0, 4, 0, 3, 0, 0, 0, 4, 3, 0, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 3, 0, 4, 3, 0, 4, 0], [0, 3, 4, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 3, 4, 3, 4, 3, 4, 3, 4, 0, 0, 0, 0, 3, 4, 5, 3, 4, 0, 0, 3, 0, 4, 0, 0, 3, 4, 0, 3, 4, 0, 0, 0, 0, 0, 3, 4, 3, 4, 3, 4, 1, 2, 3, 4, 0, 0, 0, 0, 0, 3, 4, 3, 4, 0], [0, 3, 4, 0, 0, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 6, 3, 4, 0, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 0, 6, 0, 3, 4, 3, 4, 6, 3, 4, 0, 0, 3, 4, 0, 3, 4, 6, 0, 0, 0, 0, 3, 4, 3, 4, 3, 4, 0, 0, 3, 4, 1, 2, 0, 1, 2, 0, 1, 2, 1, 5, 3, 4, 0, 1, 2, 0, 1, 2], [0, 3, 0, 0, 0, 0, 4, 3, 4, 0, 3, 0, 0, 0, 0, 0, 0, 0, 4, 0, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 0, 0, 4, 3, 4, 3, 4, 0, 3, 4, 0, 1, 2, 3, 4, 5, 3, 4, 3, 4, 3, 4, 5, 0, 5, 5, 1, 2, 0, 0, 3, 4, 0, 0, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 3, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 5, 3, 4, 0], [0, 0, 0, 3, 4, 0, 3, 0, 4, 3, 0, 4, 0, 3, 4, 0, 3, 4, 0, 0, 0, 3, 4, 0, 0, 3, 0, 4, 0, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 0, 0, 3, 0, 4, 0, 3, 0, 4, 0, 3, 0, 0, 0, 0, 4, 3, 4, 3, 4, 3, 0, 4, 5, 3, 0, 4, 0, 0, 3, 0, 4, 0, 0, 0], [0, 3, 0, 4, 3, 4, 3, 0, 4, 0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 3, 0, 4, 3, 0, 4, 0, 3, 0, 4, 3, 4, 3, 4, 3, 0, 4, 3, 4, 0, 3, 0, 4, 3, 4, 3, 4, 5, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 0, 3, 0, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 0, 4, 0, 3, 4, 0, 0, 3, 4, 3, 0, 4, 3, 0, 0, 0, 4, 3, 4, 5, 1, 2, 3, 0, 4, 3, 0, 4, 3, 4, 3, 4, 0], [0, 3, 0, 0, 0, 0, 0, 4, 3, 4, 0, 3, 4, 0, 3, 0, 4, 0, 3, 4, 0, 3, 0, 4, 3, 4, 3, 4, 0, 3, 4, 0, 3, 0, 4, 3, 4, 1, 0, 2, 0, 0, 0, 0, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 3, 4, 3, 4, 3, 4, 0], [0, 0, 6, 6, 6, 1, 2, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 1, 2, 1, 2, 3, 4, 6, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 1, 2, 3, 4, 3, 4, 1, 2, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 1, 2, 3, 4, 5], [0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 3, 0, 4, 0, 3, 4, 0, 0, 3, 4, 3, 0, 0, 4, 5, 0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 1, 1, 2, 2, 6, 0, 0, 0, 3, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 0, 3, 0, 4, 0, 0, 0], [0, 3, 0, 0, 0, 0, 0, 4, 0, 0, 0, 0, 0, 3, 0, 4, 0, 3, 4, 0, 3, 0, 4, 0, 3, 4, 3, 0, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 0, 3, 4, 3, 4, 5, 3, 4, 3, 4, 0, 0, 3, 0, 4, 3, 4, 3, 4, 0], [0, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 0, 0, 1, 0, 0, 2, 5, 1, 2, 3, 4, 3, 4, 5, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 0, 5, 3, 4, 1, 2, 1, 2, 6, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 3, 4, 6, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 3, 4], [0, 0, 3, 4, 3, 4, 3, 4, 3, 0, 4, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 0], [0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 3, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 3, 0, 4, 0, 0, 3, 0, 4, 0, 3, 0, 4, 0], [0, 3, 0, 0, 0, 0, 0, 4, 3, 4, 3, 0, 4, 3, 4, 0, 3, 4, 0, 3, 0, 0, 0, 4, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 0, 0, 3, 4, 3, 4, 3, 0, 4, 3, 4, 5, 5, 0, 3, 4, 3, 0, 4, 3, 4, 3, 4, 0, 3, 4], [0, 3, 4, 0, 3, 4, 0, 3, 0, 0, 0, 0, 0, 4, 0, 0, 3, 4, 3, 4, 3, 4, 3, 0, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 4, 0, 3, 0, 0, 4, 3, 4, 0, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 0, 3, 4, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 4, 0, 3, 0, 4, 0, 0, 0, 3, 4], [0, 3, 4, 0, 0, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 0, 3, 4, 0, 0, 3, 4, 0, 3, 4, 0, 0], [0, 3, 4, 0, 3, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 3, 4, 3, 0, 4, 0, 0, 3, 4, 0, 0, 3, 0, 4, 3, 4, 0, 3, 4, 3, 4, 3, 4, 3, 4, 0, 3, 4, 3, 4, 0, 3, 4, 0, 3, 4, 1, 2, 0, 3, 4, 0], [0, 3, 4, 0, 0, 0, 0, 3, 4, 3, 4, 0, 3, 4, 3, 0, 4, 0, 0, 3, 0, 0, 0, 4, 3, 4, 3, 4, 1, 2, 3, 4, 5, 3, 4, 3, 4, 3, 4, 0, 3, 0, 4, 0, 3, 4, 0, 3, 0, 4, 3, 4, 0, 0, 3, 0, 4, 0, 0, 0], [0, 3, 4, 3, 0, 4, 0, 3, 4, 0, 3, 4, 3, 0, 4, 0, 3, 4, 0, 3, 0, 4, 3, 4, 0, 3, 0, 0, 0, 4, 0, 3, 4, 3, 4, 0, 0, 0, 3, 4, 3, 0, 4, 0, 3, 4, 0]]
allTask2CombinedLengths = [40, 71, 96, 129, 74, 121, 64, 81, 62, 59, 117, 26, 53, 60, 80, 27, 60, 60, 47]

selectedList = input("Select list to analyze: ")
# 1: combined task 1
# 2: combined task 2
# 3: expert task 1
# 4: intermediate task 1
# 5: expert task 2
# 6: intermediate task 2

emissions = []
lengths = []

if selectedList == "1":
    print("#1: combined task 1")
    emissions = allTask1Combined
    lengths = np.array(allTask1CombinedLengths)
elif selectedList == "2":
    print("#2: combined task 2")
    emissions = allTask2Combined
    lengths = np.array(allTask2CombinedLengths)
elif selectedList == "3":
    print("#3: expert task 1")
    emissions = Expert1StartEnd
    lengths = np.array(Expert1LengthsSE)
elif selectedList == "4":
    print("#4: intermediate task 1")
    emissions = Intermediate1StartEnd
    lengths = np.array(Intermediate1LengthsSE)
elif selectedList == "5":
    print("#5: expert task 2")
    emissions = Expert2StartEnd
    lengths = np.array(Expert2LengthsSE)
elif selectedList == "6":
    print("#6: intermediate task 2")
    emissions = Intermediate2StartEnd
    lengths = np.array(Intermediate2LengthsSE)
else:
    print("Error")
    sys.exit()

# turn each sub-list within the emissions list into a numpy array
emissions = np.array([np.array(i) for i in emissions], dtype=object)

# prepping the array to store the concatenated array of all the emissions
combined = np.array([])
combined = combined[:, np.newaxis]

# converting each participant's array into (1,0) shape then concatenate it into the combined array
for i in emissions:
    temp = i[:, np.newaxis]
    combined = np.concatenate((combined.astype(int), temp.astype(int)))
# print(combined)
# print(combined.shape)





#"""
iterationsData = {'nComponents': [], 'iteration': [], "person": [], "logLikelihood": [], "monitor_iterations": []}
iterationsData = pd.DataFrame(data=iterationsData)
# print(iterationsData)
print("")

lowestBIC = np.infty
bestLogLikelihood = -(np.infty)
#bic = []
bic = {"1":[], "2":[], "3":[],"4":[],"5":[],"6":[], "7":[], "8":[]}


# OG VERSION, not removing individuals each run
for nComponents in range(1,7+1): #7+1 # we've got 7 categories right now, 0 to 6
    print("\nnComponents = " + str(nComponents))

    for iteration in range(4): #5 before # want to run multiple iterations
        model = MultinomialHMM(n_components=nComponents, verbose=False, n_iter=1000)  # init_params="ste"
        model.fit(combined, lengths)
        #print(model.monitor_)

        nFeatures = model.n_features
        k = nComponents*nComponents*(nComponents-1) + (nComponents-1) + (nComponents)*(nFeatures)
        #print("k = " + str(k))
        logLikelihood = model.score(combined)
        currentBIC = calculateBIC(k, combined, logLikelihood)

        #"""
        iterationData = pd.DataFrame(
            {'nComponents': [nComponents], 'iteration': [iteration],
             "logLikelihood": [round(logLikelihood, 4)], "monitor_iterations": [model.monitor_.iter],
             "BIC": [currentBIC]})
        # print(iterationData)
        iterationsData = iterationsData.append(iterationData, ignore_index=True)
        #"""

        bic[str(nComponents)].append(round(currentBIC,1))
        print("Iteration: ", end="")
        print(str(iteration))
        print("Current BIC: ", end="")
        print(currentBIC)
        print("LogLikelihood: ", end="")
        print(logLikelihood)
        print("")
        if currentBIC < lowestBIC:
            lowestBIC = currentBIC
            bestHMM = model
        if bestLogLikelihood < logLikelihood:
            bestLogLikelihood = logLikelihood


np.set_printoptions(precision=2, suppress=True)
print("########################################")
print("lowestBIC is: ")
print(lowestBIC)
print("best loglikelihood: ")
print(bestLogLikelihood)
print("Best model")
print("transmat")
pprint.pprint(bestHMM.transmat_)
print("startprob")
pprint.pprint(bestHMM.startprob_)
print("emissionprob")
pprint.pprint(bestHMM.emissionprob_)
print("BICs")
pprint.pprint(bic)
#"""



#"""
# manually setting ncomponents =
nComponents = 6
combined = np.array([])
combined = combined[:, np.newaxis]
for i in emissions:
    temp = i[:, np.newaxis]
    combined = np.concatenate((combined.astype(int), temp.astype(int)))
model = MultinomialHMM(n_components=nComponents, verbose=False, n_iter=1000)  # init_params="ste"
model.fit(combined, lengths)
np.set_printoptions(precision=2, suppress=True)
print("\n### Calculating if nComponent parameter is set to: " + str(nComponents) + " ###")
print("transmat")
pprint.pprint(model.transmat_)
print("startprob")
pprint.pprint(model.startprob_)
print("emissionprob")
pprint.pprint(model.emissionprob_)
print("#########################################")
#"""

"""
# manually setting ncomponents =4
nComponents = 4
combined = np.array([])
combined = combined[:, np.newaxis]
for i in emissions:
    temp = i[:, np.newaxis]
    combined = np.concatenate((combined.astype(int), temp.astype(int)))
model = MultinomialHMM(n_components=nComponents, verbose=False, n_iter=1000)  # init_params="ste"
model.fit(combined, lengths)
np.set_printoptions(precision=2, suppress=True)
print("\n### Calculating if nComponent parameter is set to: " + str(nComponents) + " ###")
print("transmat:")
pprint.pprint(model.transmat_)
print("startprob:")
pprint.pprint(model.startprob_)
print("emissionprob:")
pprint.pprint(model.emissionprob_)
print("#########################################")
"""

iterationsDataName = "./HMM_Outputs/iterationsData" + str(selectedList) + ".csv"
json = iterationsData.to_csv(iterationsDataName)

figFileName = "iterationsData" + selectedList + "_BIC.png"
figFilePath = os.path.join(os.getcwd(), "HMM_outputs", figFileName)
sns.set_theme(style="darkgrid")
ax = sns.pointplot(x="nComponents", y="logLikelihood", data=iterationsData, ci=90)
plt.savefig(figFilePath)
plt.show()